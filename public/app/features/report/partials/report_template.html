<navbar icon="fa fa-fw fa-list-alt" title-url="/report">
  <ul class="nav">
    <li><a href="/report" translate="page_report_title"></a></li>
    <li class="active"><a href="/report/template" translate="page_report_setting"></a></li>
    <!-- <li><a href="/report/edit">报告编辑</a></li> -->
  </ul>
</navbar>

<div class="page-container" ng-init="ctrl.initTemplate()">
  <div class="page-header">
    <h2 translate="page_report_setting"></h2>
  </div>
  <div ng-if="!ctrl.reportTemplate.enabled" class="no-data-box">
    <p translate="page_report_setting_none"></p>
    <p>
      <button class="btn btn-primary" ng-click="ctrl.reportTemplate.enabled = true" translate="page_report_setting"></button>
    </p>
  </div>
  <div ng-if="ctrl.reportTemplate.enabled">
    <form class="gf-form-group">
      <!-- <div class="parse-form-group">
        <div class="gf-form">
          <span class="gf-form-label width-10">消息推送开启
            <em>*</em>
          </span>
          <cwiz-switch switch-class="summary-switch" enabled="ctrl.reportTemplate.notificationEnabled" on-change="ctrl.switch();"
          data-text-on="开启" data-text-off="关闭"></cwiz-switch>
        </div>

        <div class="gf-form">
          <span class="gf-form-label width-10">推送邮箱
            <em>*</em>
          </span>
          <div class="gf-form report-email" ng-repeat="email in ctrl.reportTemplate.recipients">
            <input class="gf-form-input max-width-21" type="email" ng-model="email" ng-blur="ctrl.updateEmail(email, $index)" />
            <i ng-click="ctrl.removeEmail($index)" class="fa fa-remove"></i>
          </div>
          <a class="btn btn-success" ng-click="ctrl.addEmail()"><i class="fa fa-plus"></i></a>
        </div>

        <div class="gf-form">
          <span class="gf-form-label width-10">推送时间
            <em>*</em>
          </span>
          周一 <input class="gf-form-input width-5" type="number" min=0 max=24 required ng-model="ctrl.reportTemplate.deliverHour" /> 时
        </div>
      </div> -->

      <div class="parse-form-group">
        <div class="gf-form">
          <span class="gf-form-label width-10" translate="page_report_template"></span>
          <tip>请选择您需要定期查看的模板</tip>
        </div>

        <div class="gf-form template-container">
          <div class="template-item" ng-click="ctrl.chooseTemplate(template)" ng-repeat="template in ctrl.reportTemplate.sections">
            <p>{{template.name}}</p>
            <div class="template-img" ng-class="{true: 'active'}[template.selected]">
              <i class="fa fa-check" ng-if="template.selected"></i>
              <img style="width: 80%; height: 80%;" src="public/img/{{template.img}}" alt="">
              <p ng-if="template.selected"></p>
              <p ng-if="!template.selected"></p>
            </div>
          </div>
        </div>
      </div>

      <div class="parse-form-group no-border">
        <a class="btn btn-success" ng-click="ctrl.saveTemplate()" translate="i18n_save"></a>
        <a class="btn btn-primary" ng-click="ctrl.disableReport()" ng-if="ctrl.enabled" translate="page_report_unsubscribe"></a>
        <a class="btn btn-inverse" href="/report" translate="i18n_cancel"></a>
      </div>
    </form>
  </div>
</div>